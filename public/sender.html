<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <title>DeviceShare - Fast & Secure File Sharing Between Devices</title>
  <link rel="stylesheet" href="styles.css" />
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
   <meta name="description" content="DeviceShare lets you quickly and securely share files and texts between devices without cloud storage. No signup required.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <header>
        <div class="container">
            <nav>
                <a href="./index.html" class="logo">DeviceShare</a>
                <ul class="nav-links">
                   
                    <!-- <li><a href="https://your-donation-link.com" target="_blank" class="donate-btn">❤️ Donate</a></li> -->
                    <li><script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Donate ', '#72a4f2', 'W7W31JKWOX');kofiwidget2.draw();</script> </li>
                </ul>
            </nav>
        </div>
    </header>
      

  <div class="container sender-con">
    <div class="left">
      <h1>Sender Panel</h1>
      <div id="room-code" title="Room Code"></div>
      <div id="qr-code" aria-label="QR Code to join the room"></div>
    </div>
    <div class="right">
      <textarea id="text-input" placeholder="Type a message..." aria-label="Message input"></textarea>
      <button id="send-text">Send Text</button>
      <input type="file" id="file-input" aria-label="Select file to send" />
      <button id="send-file">Send File</button>
      <div id="status" role="status" aria-live="polite"></div>
<script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Donate ', '#2e5aa6', 'W7W31JKWOX');kofiwidget2.draw();</script> 
    </div>

    
  </div>





    <section class="features" id="features">
        <div class="container">
            <div class="section-title">
                <h2>Why Choose DeviceShare</h2>
                <p>Our platform offers the fastest and most secure way to share files between devices</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <i class="fas fa-bolt"></i>
                    <h3>Lightning Fast</h3>
                    <p>Transfer files directly between devices without slow cloud uploads and downloads.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-lock"></i>
                    <h3>End-to-End Encryption</h3>
                    <p>Your files are encrypted during transfer and never stored on our servers.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-infinity"></i>
                    <h3>No Size Limits</h3>
                    <p>Share files of any size without restrictions or compression.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-desktop"></i>
                    <h3>Cross-Platform</h3>
                    <p>Works on all devices - Windows, Mac, Linux, iOS, and Android.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-adjust"></i>
                    <h3>No Registration</h3>
                    <p>Start sharing immediately without creating an account.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-history"></i>
                    <h3>24-Hour Availability</h3>
                    <p>Files are available for 24 hours after sharing for convenience.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="how-it-works" id="how-it-works">
        <div class="container">
            <div class="section-title">
                <h2>How It Works</h2>
                <p>Sharing files between devices has never been easier</p>
            </div>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Create a Room </h3>
                    <p>Start a session and get a unique code or QR.</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Join the Room</h3>
                    <p>Enter the code or scan the QR to connect.</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Send Files or Text</h3>
                    <p>Upload files or type messages to share instantly.</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3>Receive & Download</h3>
                    <p>Receiver gets and downloads files in real time.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="cta">
        <div class="container">
            <h2 >Support/Donate</h2>
             <p>Support us by donating, and keep this project free for all</p>
            <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Donate ', '#1b1e24', 'W7W31JKWOX');kofiwidget2.draw();</script> 
        </div>
    </section>

    
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column first">
                    <h3>DeviceShare</h3>
                    <p>The fastest way to share files between devices without cloud storage.</p>
                </div>
              <div class="footer-column">
                    <!-- <h3>Features</h3> -->
                    <ul>
                        <li><a href="./index.html#features">About us</a></li>
                        <li><a href="./index.html#how-it-works">How it works</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <ul>
                        <li><a target="_blank" href="https://ko-fi.com/dkm13">Donate us</a></li>
                    </ul>
                </div>
              
            </div>
            <div class="copyright">
                <p>&copy; 2025 DeviceShare. Developed by <a class="creator-link" href="https://dibran13.netlify.app/">Dkm 13</a></p>
            </div>
        </div>
    </footer>


  <script>
   

    const params = new URLSearchParams(window.location.search);
    const roomCode = params.get('room');
    if (!roomCode) {
      alert('No room code found in URL.');
      throw new Error('No room code');
    }

    const roomCodeDiv = document.getElementById('room-code');
    const qrCodeDiv = document.getElementById('qr-code');
    const statusDiv = document.getElementById('status');

    roomCodeDiv.innerText = `Room Code: ${roomCode}`;

    // Generate QR code using external API for current room
    const joinUrl = `${location.protocol}//${location.host}/receiver.html?room=${roomCode}`;
    const img = document.createElement('img');
    img.src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(joinUrl)}`;
    img.alt = 'Join QR Code';
    img.style.marginTop = '1rem';
    qrCodeDiv.innerHTML = '<strong>Join via QR Code:</strong><br>';
    qrCodeDiv.appendChild(img);

    const ws = new WebSocket(`ws://${location.host}`);
    ws.onopen = () => {
      ws.send(JSON.stringify({ type: 'join', room: roomCode }));
    };

    ws.onclose = () => {
      statusDiv.innerText = 'Disconnected from server.';
    };

    // Send text message
    const sendTextBtn = document.getElementById('send-text');
    const textInput = document.getElementById('text-input');

    sendTextBtn.onclick = () => {
      const text = textInput.value.trim();
      if (!text) return;

      sendTextBtn.disabled = true;
      ws.send(JSON.stringify({ type: 'text', text }));
      textInput.value = '';
      textInput.focus();
      statusDiv.innerText = 'Text sent!';
      setTimeout(() => {
        statusDiv.innerText = '';
        sendTextBtn.disabled = false;
      }, 1500);
    };

    // Send file
    const sendFileBtn = document.getElementById('send-file');
    const fileInput = document.getElementById('file-input');

    sendFileBtn.onclick = async () => {
      const file = fileInput.files[0];
      if (!file) {
        alert('Please select a file first.');
        return;
      }

      sendFileBtn.disabled = true;
      const formData = new FormData();
      formData.append('file', file);
      formData.append('room', roomCode);

      try {
        const res = await fetch('/api/upload', {
          method: 'POST',
          body: formData,
        });
        const json = await res.json();
        if (json.success) {
          statusDiv.innerText = 'File sent!';
          fileInput.value = '';
          fileInput.focus();
          setTimeout(() => {
            statusDiv.innerText = '';
            sendFileBtn.disabled = false;
          }, 1500);
        } else {
          statusDiv.innerText = 'Upload failed.';
          sendFileBtn.disabled = false;
        }
      } catch {
        statusDiv.innerText = 'Upload failed.';
        sendFileBtn.disabled = false;
      }
    };
  </script>
</body>
</html>
